<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><meta property="og:title" content="ä¸ºåšå®¢æ”¯æŒè¯„è®ºç³»ç»Ÿ â€” ç‹ç‹¸åèµ°çŸ£" /><meta property="og:site_name" content="ç‹ç‹¸åèµ°çŸ£" /><meta property="og:image" content="https://blog.southfox.me/favicon.png" /><meta name="fediverse:creator" content="SouthFox@foxsay.southfox.me" /><title>ä¸ºåšå®¢æ”¯æŒè¯„è®ºç³»ç»Ÿ â€” ç‹ç‹¸åèµ°çŸ£</title><link rel="me" href="https://foxsay.southfox.me/@SouthFox" /><link rel="me" href="https://codeberg.org/southfox" /><script src="/assets/js/lips.min.js"></script><link rel="stylesheet" href="/assets/css/main.css" /><script type="text/x-scheme">(let ((font (or (localStorage.getItem "font") "zpix")) (font-select (document.getElementById "font-select"))) (define (string=? a b) (== (a.cmp b) 0)) (define (loop-set options value) (let loop ((i 0)) (if (> i (- (length options) 1)) i (let ((option (get options i))) (if (string=? option.value value) (option.setAttribute "selected" #t) (loop (+ 1 i))))))) (define (set-font font-name) (localStorage.setItem "font" font-name) (document.documentElement.setAttribute "data-font" font-name) (if font-select (loop-set font-select.options font-name))) (font-select.addEventListener "change" (lambda (event) (set-font event.target.value))) (set-font font))</script><link rel="alternative" href="/feed.xml" title="ç‹ç‹¸åèµ°çŸ£" type="application/atom+xml" /><link rel="alternative" href="/rss2.xml" title="ç‹ç‹¸åèµ°çŸ£" type="application/rss+xml" /></head><body><nav class="nav"><a href="/" class="brand"><span>ç‹ç‹¸åèµ°çŸ£</span></a><input id="bmenub" type="checkbox" class="show" aria-label="open menu" /><label for="bmenub" class="burger pseudo button">â˜°</label><div class="menu"><a href="/archives/">å½’æ¡£</a><a href="/tags/">æ ‡ç­¾</a><a href="/search/">æœç´¢</a><a href="/about/">å…³äº</a></div></nav><div class="container flex"><div class="content"><main data-pagefind-body="true"><div><h2>ä¸ºåšå®¢æ”¯æŒè¯„è®ºç³»ç»Ÿ</h2><h3>by SouthFox</h3><h3 data-pagefind-sort="date">2022-01-31</h3><div><p>çªç„¶å‘ç°åŠ å…¥åå¹´ä¹‹çº¦çš„åšå®¢è¯„è®ºåŒºéƒ½å¥½çƒ­é—¹â€¦â€¦ä¼¼ä¹éƒ½æ˜¯éšæœºè®¿é—®è¿‡æ¥çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰å¿…è¦ä¸ºåšå®¢åŠ ä¸Šè¯„è®ºç³»ç»Ÿçš„ï¼Ÿ</p><span id="more"></span><p>è€ƒå¯Ÿäº†ä¸€ç•ªé€‰æ‹©äº†ä¾é  <code>GitHub Discussions</code> çš„ <code>Giscus</code> åšä¸ºåšå®¢çš„è¯„è®ºç³»ç»Ÿã€‚</p><h2 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h2><p>ğŸ‘ ä¼˜ç‚¹ï¼š</p><ul><li>æ¯”èµ· <code>Gitalk</code> ï¼Œæ‹¥æœ‰æ›´å°çš„æƒé™è¯·æ±‚</li><li>éƒ¨ç½²ä¹Ÿæ–¹ä¾¿ï¼Œååˆ†é’Ÿå†…éƒ½èƒ½è½»æ¾æå®š</li><li>æ•°æ®å®‰å…¨ä¹Ÿæœ‰ <code>GitHub</code> åšèƒŒä¹¦ï¼Œè‡³å°‘æ¯”è‡ªå»ºå¼º</li><li>æ‹‰å– <code>Discussions</code> æ•°æ®çš„è„šæœ¬æ˜¯æ”¾åœ¨ <code>vercel</code> ä¸Šï¼Œå›½å†…çœ‹è¯„è®ºè‡³å°‘æ˜¯æ²¡é—®é¢˜çš„</li></ul><p>ğŸ™ƒ ç¼ºç‚¹ï¼š</p><ul><li>è¯„è®ºå¾—éœ€è¦ä¸ª <code>GitHub</code> å¸å·ï¼Œå¯¹äºæ²¡æœ‰ç›¸å…³ç»éªŒçš„äººçœŸå¯è°“å¹æ¯ä¹‹å¢™äº†ï¼Œä½†æ˜¯ä¹Ÿä¸å…¨æ˜¯åäº‹ï¼Œå€’åƒåœ¾è¯„è®ºä¹Ÿèƒ½éš”ç»æ‰å¤§éƒ¨åˆ†ã€‚</li></ul><h2 id="éƒ¨ç½²">éƒ¨ç½²</h2><ol><li>ä¸ºä»“åº“å¼€å¯ <code>Discussions</code> ï¼Œä»“åº“ Setting --&gt; Features --&gt; å‹¾é€‰ Discussions ã€‚</li><li>å…ˆå» <a href="https://github.com/apps/giscus" class="external_link">GitHub åº”ç”¨é¡µ</a> å®‰è£… <code>Giscus</code> ï¼Œå¯ä»¥ä»…ç»™æŒ‡å®šçš„ä»“åº“æˆæƒã€‚</li><li>åœ¨åˆ° <a href="https://giscus.app/zh-CN" class="external_link">Giscus å®˜ç½‘</a> è¿›è¡Œé…ç½®ï¼Œè¾“å…¥ä»“åº“åï¼Œå†³å®šæ˜ å°„æ–¹å¼ç­‰ã€è¯„è®ºæ ·å¼ç­‰ã€‚</li><li>æœ€åç”Ÿæˆä¸€ä¸ªè„šæœ¬ä»£ç ï¼ŒåµŒå…¥åˆ°åšå®¢æ–‡ç« æ¨¡æ¿åº•éƒ¨ï¼Œæå®šï¼</li></ol><h2 id="å‘">å‘</h2><p>å¦‚æœæ˜ å°„æ–¹å¼é€‰æ‹© <code>pathname</code>ï¼Œè€Œ uri é‡ŒåŒ…å«ä¸­æ–‡ï¼Œå°†ä¼šè¢«è§£ç ï¼Œæå¾—éå¸¸ä¹±ã€‚æ‰€ä»¥å¯ä»¥è‡ªå·±éº»çƒ¦ä¸€ç‚¹ï¼Œæ‰‹åŠ¨æŒ‡å®šã€‚</p><p>å¦‚ <code>Hexo</code> ï¼Œåœ¨ <code>head</code> æ¨¡æ¿ä¸­æ’å…¥åˆ° <code>&lt;head&gt;</code> æ ‡ç­¾é‡Œï¼š</p><pre><code>&lt;% if (page.title){ %&gt;&lt;meta property=&quot;og:title&quot; content=&quot;&lt;%= page.path %&gt;&quot;/&gt;&lt;% } %&gt;</code></pre><p>ä¹‹å <code>Giscus</code> é€‰æ‹©ä¸º <code>og:title</code> ï¼Œè¿™æ ·å°±ç¡®ä¿æ ‡é¢˜ä¸ä¼šè¢«è½¬ç äº†ã€‚</p><h2 id="è‡ªåŠ¨åˆå§‹åŒ–">è‡ªåŠ¨åˆå§‹åŒ–</h2><p>æ€»ä½“æ¥è¯´è¿˜æ˜¯ä¸é”™çš„ï¼Œå†æŠ˜è…¾ä¸€ä¸‹å¯ä»¥é€‰æ‹©è‡ªå»ºï¼Œè¿™æ ·å¯ä»¥é¿å¼€å¯¹è„šæœ¬æ‰€åœ¨åŸŸåçš„å°é”ï¼Œæˆ–è€…éƒ¨ç½²æ—¶è‡ªåŠ¨åˆ›å»ºå¯¹åº”å¸–å­ï¼Œ&lt;del&gt;ä¸è¿‡æŒºéº»çƒ¦ï¼Œä»¥ååœ¨æ‘¸å§ ğŸŸ ã€‚&lt;/del&gt;</p><p><strong>3-13 æ›´æ–°ï¼š</strong></p><p>å…¶å®å¾ˆæ—©å°±æ‘¸äº†ï¼Œåªæ˜¯æˆ‘æ†‹ç€ä¸æ”¾è€Œå·²ï¼ˆ</p><pre><code><span class="syntax-special">import</span> <span class="syntax-symbol">sys</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">os</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">requests</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">json</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">getopt</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">re</span>
<span class="syntax-special">import</span> <span class="syntax-symbol">random</span>
<span class="syntax-special">from</span> <span class="syntax-symbol">datetime</span> <span class="syntax-special">import</span> <span class="syntax-symbol">datetime</span>



<span class="syntax-special">def</span> <span class="syntax-symbol">addDiscussion</span><span class="syntax-open">(</span><span class="syntax-close">)</span><span class="syntax-operator">:</span>
    <span class="syntax-symbol">currentYear</span> <span class="syntax-operator">=</span> <span class="syntax-keyword">str</span><span class="syntax-open">(</span><span class="syntax-symbol">datetime</span><span class="syntax-operator">.</span><span class="syntax-symbol">now</span><span class="syntax-open">(</span><span class="syntax-close">)</span><span class="syntax-operator">.</span><span class="syntax-symbol">year</span><span class="syntax-close">)</span>
    <span class="syntax-symbol">repo_id</span><span class="syntax-operator">=</span><span class="syntax-string">&quot;aaabbb&quot;</span>
    <span class="syntax-symbol">category_id</span><span class="syntax-operator">=</span><span class="syntax-string">&quot;cccddd&quot;</span>
    <span class="syntax-symbol">DISCUSSIONS_TOKEN</span><span class="syntax-operator">=</span><span class="syntax-symbol">os</span><span class="syntax-operator">.</span><span class="syntax-symbol">environ</span><span class="syntax-operator">.</span><span class="syntax-symbol">get</span><span class="syntax-open">(</span><span class="syntax-string">'DISCUSSIONS_TOKEN'</span><span class="syntax-close">)</span> <span class="syntax-comment">#æ ¹æ®è‡ªå·±å®é™…æƒ…å†µé€‰æ‹©
</span>
    <span class="syntax-symbol">header</span> <span class="syntax-operator">=</span> <span class="syntax-open">{</span>
        <span class="syntax-string">&quot;Authorization&quot;</span><span class="syntax-operator">:</span> <span class="syntax-symbol">f</span><span class="syntax-string">&quot;Bearer {DISCUSSIONS_TOKEN}&quot;</span>
    <span class="syntax-close">}</span>
    <span class="syntax-symbol">data</span> <span class="syntax-operator">=</span> <span class="syntax-open">{</span>
        <span class="syntax-string">'query'</span><span class="syntax-operator">:</span> <span class="syntax-comment">&quot;&quot;&quot;query{repository(owner:&quot;name&quot;,name:&quot;repo_name&quot;){
                id discussions(first:100, categoryId: &quot;aaabbb&quot;){
                    nodes{
                        title
                    }
                }
            }
        }&quot;&quot;&quot;</span>
    <span class="syntax-close">}</span>
    <span class="syntax-symbol">url</span> <span class="syntax-operator">=</span> <span class="syntax-string">'https://api.github.com/graphql'</span>

    <span class="syntax-symbol">r</span> <span class="syntax-operator">=</span> <span class="syntax-symbol">requests</span><span class="syntax-operator">.</span><span class="syntax-symbol">post</span><span class="syntax-open">(</span><span class="syntax-symbol">url</span><span class="syntax-operator">,</span> <span class="syntax-symbol">headers</span><span class="syntax-operator">=</span><span class="syntax-symbol">header</span><span class="syntax-operator">,</span> <span class="syntax-symbol">data</span><span class="syntax-operator">=</span><span class="syntax-symbol">json</span><span class="syntax-operator">.</span><span class="syntax-symbol">dumps</span><span class="syntax-open">(</span><span class="syntax-symbol">data</span><span class="syntax-close">)</span><span class="syntax-close">)</span>
    <span class="syntax-special">if</span> <span class="syntax-symbol">r</span><span class="syntax-operator">.</span><span class="syntax-symbol">status_code</span> <span class="syntax-operator">==</span> <span class="syntax-symbol">200</span><span class="syntax-operator">:</span>
        <span class="syntax-symbol">discussions</span> <span class="syntax-operator">=</span> <span class="syntax-symbol">r</span><span class="syntax-operator">.</span><span class="syntax-symbol">json</span><span class="syntax-open">(</span><span class="syntax-close">)</span>

    <span class="syntax-symbol">discussions</span> <span class="syntax-operator">=</span> <span class="syntax-symbol">discussions</span><span class="syntax-open">[</span><span class="syntax-string">&quot;data&quot;</span><span class="syntax-close">]</span><span class="syntax-open">[</span><span class="syntax-string">&quot;repository&quot;</span><span class="syntax-close">]</span><span class="syntax-open">[</span><span class="syntax-string">&quot;discussions&quot;</span><span class="syntax-close">]</span><span class="syntax-open">[</span><span class="syntax-string">&quot;nodes&quot;</span><span class="syntax-close">]</span>

    <span class="syntax-symbol">discu_list</span> <span class="syntax-operator">=</span> <span class="syntax-open">[</span><span class="syntax-close">]</span>
    <span class="syntax-special">for</span> <span class="syntax-symbol">i</span> <span class="syntax-special">in</span> <span class="syntax-symbol">discussions</span><span class="syntax-operator">:</span>
        <span class="syntax-symbol">discu_list</span><span class="syntax-operator">.</span><span class="syntax-symbol">append</span><span class="syntax-open">(</span><span class="syntax-symbol">i</span><span class="syntax-open">[</span><span class="syntax-string">&quot;title&quot;</span><span class="syntax-close">]</span><span class="syntax-close">)</span>

    <span class="syntax-special">for</span> <span class="syntax-symbol">post</span> <span class="syntax-special">in</span> <span class="syntax-symbol">postlist</span><span class="syntax-operator">:</span>
        <span class="syntax-special">if</span> <span class="syntax-symbol">currentYear</span> <span class="syntax-special">not</span> <span class="syntax-special">in</span> <span class="syntax-symbol">post</span><span class="syntax-operator">:</span>
            <span class="syntax-special">continue</span>

        <span class="syntax-special">if</span> <span class="syntax-symbol">post</span> <span class="syntax-special">not</span> <span class="syntax-special">in</span> <span class="syntax-symbol">discu_list</span><span class="syntax-operator">:</span>
            <span class="syntax-symbol">data</span> <span class="syntax-operator">=</span> <span class="syntax-open">{</span>
            <span class="syntax-string">'query'</span><span class="syntax-operator">:</span> <span class="syntax-comment">&quot;&quot;&quot;mutation{
            createDiscussion(input: {repositoryId: &quot;%s&quot;, categoryId: &quot;%s&quot;, body: &quot;%s&quot;, title: &quot;%s&quot;}) {
                discussion {
                    id
                        }
                    }
                }&quot;&quot;&quot;</span> <span class="syntax-operator">%</span> <span class="syntax-open">(</span><span class="syntax-symbol">repo_id</span><span class="syntax-operator">,</span> <span class="syntax-symbol">category_id</span><span class="syntax-operator">,</span> <span class="syntax-string">'blog url'</span> <span class="syntax-operator">+</span> <span class="syntax-symbol">post</span><span class="syntax-operator">,</span> <span class="syntax-symbol">post</span><span class="syntax-close">)</span>
            <span class="syntax-close">}</span>

            <span class="syntax-symbol">r</span> <span class="syntax-operator">=</span> <span class="syntax-symbol">requests</span><span class="syntax-operator">.</span><span class="syntax-symbol">post</span><span class="syntax-open">(</span><span class="syntax-symbol">url</span><span class="syntax-operator">,</span> <span class="syntax-symbol">headers</span><span class="syntax-operator">=</span><span class="syntax-symbol">header</span><span class="syntax-operator">,</span> <span class="syntax-symbol">data</span><span class="syntax-operator">=</span><span class="syntax-symbol">json</span><span class="syntax-operator">.</span><span class="syntax-symbol">dumps</span><span class="syntax-open">(</span><span class="syntax-symbol">data</span><span class="syntax-close">)</span><span class="syntax-close">)</span>
            <span class="syntax-special">if</span> <span class="syntax-symbol">r</span><span class="syntax-operator">.</span><span class="syntax-symbol">status_code</span> <span class="syntax-operator">==</span> <span class="syntax-symbol">200</span><span class="syntax-operator">:</span>
                <span class="syntax-keyword">print</span><span class="syntax-open">(</span><span class="syntax-symbol">f</span><span class="syntax-string">&quot;åˆå§‹åŒ–å¯¹åº”è®¨è®ºï¼ {post}&quot;</span><span class="syntax-close">)</span>
                <span class="syntax-keyword">print</span><span class="syntax-open">(</span><span class="syntax-symbol">r</span><span class="syntax-operator">.</span><span class="syntax-symbol">text</span><span class="syntax-close">)</span>

<span class="syntax-special">if</span> <span class="syntax-symbol">__name__</span> <span class="syntax-operator">==</span> <span class="syntax-string">'__main__'</span><span class="syntax-operator">:</span>
    <span class="syntax-symbol">filelist</span> <span class="syntax-operator">=</span> <span class="syntax-open">[</span><span class="syntax-close">]</span>
    <span class="syntax-symbol">postlist</span> <span class="syntax-operator">=</span> <span class="syntax-open">[</span><span class="syntax-close">]</span>
    <span class="syntax-symbol">addDiscussion</span><span class="syntax-open">(</span><span class="syntax-close">)</span></code></pre><p>å­¦äº†ä¸€ä¸‹æ–°ç©æ„â€¦â€¦ <code>graphql</code> ä¼¼ä¹æ¯”åŸºäº <code>REST</code> å½¢å¼çš„æ›´å¼ºå¤§ä¸€ç‚¹ï¼Ÿ</p><p>å…¶ä¸­æ˜¯æ ¹æ®å¯¹åº”çš„ <code>access token</code> è¿›è¡Œéƒ¨ç½²ï¼Œæ‰€ä»¥è¦ä¸ºå¯¹åº”éƒ¨ç½²çš„ <code>access token</code> æŒ‡å®š <code>discussions</code> æƒé™â€¦â€¦</p><p>æ³¨æ„å…¶ä¸­çš„ <code>currentYear</code> é‚£é‡Œï¼Œå› ä¸ºåªè·å–äº†æœ€æ–°çš„ <code>100</code> æ¡æ•°æ®ï¼Œè¦æ˜¯æ–‡ç« æ•°æ®è¶…è¿‡ <code>100</code> æ¡çš„è¯æˆ–è®¸ä¼šé‡å¤åˆ›å»ºï¼Ÿæ‰€ä»¥å°±ä»…ä»…åªåˆ¤æ–­å½“å¹´çš„æ–‡ç« äº†ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²æ—¶è¯·å»æ‰æ­¤åˆ¤æ–­ã€‚é™¤éä½ æƒ³å½“è¶…æ—¶ç©ºæˆ˜å£«ä¸ºä»¥å¾€å¹´ä»½å†™æ–‡ç« æˆ–è€…æ˜¯ä¸€å¹´èƒ½å†™ <code>100</code> ç¯‡æ–‡ç« çš„äººï¼Œé‚£ä¹ˆæ­¤é€»è¾‘åº”è¯¥æ²¡é—®é¢˜â€¦â€¦å§ã€‚</p><p>æ˜¯ä¸ºäº† <code>GitHub Actions</code> å‡†å¤‡çš„ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆçš„è¯å¯ä»¥çœ‹<a href="../../03/Github-Actions-æµ…å°è¾„æ­¢">è¿™</a>ã€‚</p><h2 id="æœ€å">æœ€å</h2><p>æœ€åï¼Œæ¬¢è¿ä½ èƒ½è®¿é—®åˆ°æˆ‘è¿™è’å²›ï¼Œè¯·å‹å–„è¯„è®ºå“¦~</p></div></div></main><div class="pagination"><a class="btn" href="/2022/02/22å¹´2æœˆæ¢¦è®°/">â† ä¸Šä¸€é¡µ</a><a class="btn" href="/"> ä¸»é¡µ </a><a class="btn" href="/2021/12/2021-æ€»ç»“/">ä¸‹ä¸€é¡µ â†’</a></div><div class="comment"><blockquote>å¦‚ä¸æƒ³æˆæƒ Giscus åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»ä¸‹æ–¹<strong>å·¦ä¸Šè§’æ•°å­—</strong>ç›´æ¥è·³è½¬åˆ° Github Discussions è¿›è¡Œè¯„è®ºã€‚</blockquote><script src="https://giscus.app/client.js" data-repo="SouthFox-D/SouthFox-D.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyMjg3NDM0MjQ=" data-category="åšå®¢è¯„è®º" data-category-id="DIC_kwDODaJZAM4CA7bf" data-mapping="specific" data-term="2022/01/ä¸ºåšå®¢æ”¯æŒè¯„è®ºç³»ç»Ÿ/" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top" data-theme="dark_dimmed" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async=""></script></div></div><div class="sidebar"><div class="widget"><h4>é“¾æ¥</h4><ul><li><a href="/friends/">å‹é“¾</a></li><li><a href="https://www.travellings.cn/train.html">å¼€å¾€</a></li><li><a href="https://foreverblog.cn/go.html">è™«æ´</a></li><li><a href="/feed.xml">è®¢é˜…ï¼ˆAtom)</a></li><li><a href="/rss2.xml">è®¢é˜…ï¼ˆRss)</a></li><li><a href="https://www.lisperati.com/logo.html"><img src="/assets/img/lisplogo_warning2_128.png" alt="Lisp logo warning" /></a></li><li><a href="https://www.fsf.org/appeal"><img src="/assets/img/6838639.png" alt="FSF appeal" /></a></li></ul><div><a href="https://xn--sr8hvo.ws/previous">â†</a><a href="https://xn--sr8hvo.ws">IndieWeb Webring ğŸ’</a><a href="https://xn--sr8hvo.ws/next">â†’</a></div><div><a href="https://fediring.net/previous?host=blog.southfox.me">â†</a><a href="https://fediring.net">Fediring ğŸ’</a><a href="https://fediring.net/next?host=blog.southfox.me">â†’</a></div></div><div class="widget"><h4>è®¾ç½®</h4><div><label for="font-select">å­—ä½“è®¾ç½®ï¼š</label><select id="font-select"><option value="plain">æ™®é€š</option><option value="zpix">åƒç´ </option></select></div></div><div class="widget"><h4>æ ‡ç­¾</h4><ul><li><a href="/tag/æŠ€æœ¯">æŠ€æœ¯</a></li><li><a href="/tag/åšå®¢">åšå®¢</a></li></ul></div><div class="widget"><h4>ç›®å½•</h4><ul><li><a href="#ç‰¹ç‚¹">ç‰¹ç‚¹</a></li><li><a href="#éƒ¨ç½²">éƒ¨ç½²</a></li><li><a href="#å‘">å‘</a></li><li><a href="#è‡ªåŠ¨åˆå§‹åŒ–">è‡ªåŠ¨åˆå§‹åŒ–</a></li><li><a href="#æœ€å">æœ€å</a></li></ul></div></div></div><footer class="footer"><div class="copyright"><div><p>Â© SouthFox 2026 ,Font by <a href="https://github.com/SolidZORO/zpix-pixel-font">Zpix</a></p></div><div><p>Power by <a href="https://dthompson.us/projects/haunt.html">haunt</a> ,source can be found <a href="https://git.southfox.me/southfox/blog">here</a></p></div></div></footer></body></html>